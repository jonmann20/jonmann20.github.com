"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var l=e[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(e,i,l){return i&&t(e.prototype,i),l&&t(e,l),e}}(),BallPit=function(){function t(){var e=this;_classCallCheck(this,t),this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.radius=3.5,this.balls=[],this.canvas.width=jw.Util.getMainWidth()/1.5,this.canvas.height=this.canvas.width/2,this.boundOnNumBalls=function(t){return e.onNumBalls(t.target.value)},this.boundOnSizeBalls=function(t){return e.onSizeBalls(t.target.value)},this.boundOnSpeedBalls=function(t){return e.onSpeedBalls(t.target.value)},document.querySelector(".numBalls").addEventListener("input",this.boundOnNumBalls),document.querySelector(".sizeBalls").addEventListener("input",this.boundOnSizeBalls),document.querySelector(".speedBalls").addEventListener("input",this.boundOnSpeedBalls);for(var i=0;i<20;++i)this.balls.push({x:Math.floor(Math.random()*(this.canvas.width+1)),y:Math.floor(Math.random()*(this.canvas.height+1)),velocity:{x:Math.floor(Math.random()*-3),y:Math.floor(7*Math.random())-3}});this.runSim()}return _createClass(t,[{key:"destroy",value:function(){window.cancelAnimationFrame(this.animLoop);var t=document.querySelector(".numBalls"),e=document.querySelector(".sizeBalls"),i=document.querySelector(".speedBalls");t&&t.removeEventListener("input",this.boundOnNumBalls),e&&e.removeEventListener("input",this.boundOnSizeBalls),i&&i.removeEventListener("input",this.boundOnSpeedBalls)}},{key:"update",value:function(){var t=!0,e=!1,i=void 0;try{for(var l,n=this.balls[Symbol.iterator]();!(t=(l=n.next()).done);t=!0){var a=l.value;a.x+=a.velocity.x,a.y+=a.velocity.y,a.x<0&&a.velocity.x<0&&(a.velocity.x=-a.velocity.x),a.y>=this.canvas.height&&a.velocity.y>0&&(a.velocity.y=-a.velocity.y),a.x>=this.canvas.width&&a.velocity.x>0&&(a.velocity.x=-a.velocity.x),a.y<0&&a.velocity.y<0&&(a.velocity.y=-a.velocity.y)}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}}},{key:"render",value:function(){this.ctx.fillStyle="#0098ff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#e1e1e1";var t=!0,e=!1,i=void 0;try{for(var l,n=this.balls[Symbol.iterator]();!(t=(l=n.next()).done);t=!0){var a=l.value;this.ctx.beginPath(),this.ctx.arc(a.x,a.y,this.radius,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.lineWidth=this.radius/15,this.ctx.strokeStyle="#19a2ff",this.ctx.stroke(),this.ctx.closePath()}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}}},{key:"runSim",value:function(){var t=this;this.update(),this.render(),this.animLoop=requestAnimationFrame(function(){return t.runSim()})}},{key:"fixArr",value:function(t){var e=0,i=this.balls.length-t;if(i>0)for(;e<i;++e)this.balls.pop();else if(i<0)for(i=-i;e<i;++e){var l={x:Math.floor(Math.random()*(this.canvas.width-0+1))+0,y:Math.floor(Math.random()*(this.canvas.height+1)),velocity:{x:Math.floor(5*Math.random())+-2,y:Math.floor(7*Math.random())+-3}};0===l.velocity.x&&(l.velocity.x=1),0===l.velocity.y&&(l.velocity.y=1),this.balls.push(l)}}},{key:"updateUserSpeed",value:function(t,e){var i=void 0,l=void 0,n=!0,a=!1,o=void 0;try{for(var r,s=this.balls[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var c=r.value;i=c.velocity.x/t,l=c.velocity.y/t,c.velocity.x=i*e,c.velocity.y=l*e}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}}},{key:"onNumBalls",value:function(t){document.querySelector(".litNumBalls").textContent=t,this.fixArr(t)}},{key:"onSizeBalls",value:function(t){document.querySelector(".litSizeBalls").textContent=t,this.radius=t}},{key:"onSpeedBalls",value:function(t){this.updateUserSpeed(document.querySelector(".litSpeedBalls").textContent,t),document.querySelector(".litSpeedBalls").textContent=t}}]),t}();