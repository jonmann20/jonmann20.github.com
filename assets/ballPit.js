"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var BallPit=function(){function t(){var e=this;_classCallCheck(this,t),this.boundOnRoute=function(t){return e.destroy(t.detail)},addEventListener("route",this.boundOnRoute,!!pListen&&{passive:!0}),this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.radius=16.5,this.balls=[],this.canvas.width=util.getMainWidth()/1.5,this.canvas.height=this.canvas.width/2,this.boundOnNumBalls=function(t){return e.onNumBalls(t.target.value)},this.boundOnSizeBalls=function(t){return e.onSizeBalls(t.target.value)},this.boundOnSpeedBalls=function(t){return e.onSpeedBalls(t.target.value)},document.querySelector(".numBalls").addEventListener("input",this.boundOnNumBalls),document.querySelector(".sizeBalls").addEventListener("input",this.boundOnSizeBalls),document.querySelector(".speedBalls").addEventListener("input",this.boundOnSpeedBalls);for(var i=0;i<20;++i)this.balls.push({x:Math.floor(Math.random()*(this.canvas.width+1)),y:Math.floor(Math.random()*(this.canvas.height+1)),velocity:{x:Math.floor(-3*Math.random()),y:Math.floor(7*Math.random())-3},color:this.getRandomColor()});this.runSim()}return t.prototype.destroy=function(t){if("#playground/ballPit"!==t){removeEventListener("route",this.boundOnRoute,!!pListen&&{passive:!0}),cancelAnimationFrame(this.animLoop);var e=document.querySelector(".numBalls"),i=document.querySelector(".sizeBalls"),o=document.querySelector(".speedBalls");e&&e.removeEventListener("input",this.boundOnNumBalls),i&&i.removeEventListener("input",this.boundOnSizeBalls),o&&o.removeEventListener("input",this.boundOnSpeedBalls),delete window.ballPit}},t.prototype.update=function(){for(var t=this.balls,e=Array.isArray(t),i=0,t=e?t:t[Symbol.iterator]();;){var o;if(e){if(i>=t.length)break;o=t[i++]}else{if((i=t.next()).done)break;o=i.value}var n=o;n.x+=n.velocity.x,n.y+=n.velocity.y,n.x-this.radius<0&&n.velocity.x<0&&(n.velocity.x=-n.velocity.x),n.y>=this.canvas.height-this.radius&&n.velocity.y>0&&(n.velocity.y=-n.velocity.y),n.x>=this.canvas.width-this.radius&&n.velocity.x>0&&(n.velocity.x=-n.velocity.x),n.y-this.radius<0&&n.velocity.y<0&&(n.velocity.y=-n.velocity.y)}},t.prototype.render=function(){this.ctx.fillStyle="#0098ff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);for(var t=this.balls,e=Array.isArray(t),i=0,t=e?t:t[Symbol.iterator]();;){var o;if(e){if(i>=t.length)break;o=t[i++]}else{if((i=t.next()).done)break;o=i.value}var n=o;this.ctx.fillStyle=n.color,this.ctx.beginPath(),this.ctx.arc(n.x,n.y,this.radius,0,2*Math.PI,!1),this.ctx.fill()}},t.prototype.runSim=function(){var t=this;this.update(),this.render(),this.animLoop=requestAnimationFrame(function(){return t.runSim()})},t.prototype.fixArr=function(t){var e=0,i=this.balls.length-t;if(i>0)for(;e<i;++e)this.balls.pop();else if(i<0)for(i=-i;e<i;++e){var o={x:Math.floor(Math.random()*(this.canvas.width-0+1))+0,y:Math.floor(Math.random()*(this.canvas.height+1)),velocity:{x:Math.floor(5*Math.random())+-2,y:Math.floor(7*Math.random())+-3},color:this.getRandomColor()};0===o.velocity.x&&(o.velocity.x=1),0===o.velocity.y&&(o.velocity.y=1),this.balls.push(o)}},t.prototype.updateUserSpeed=function(t,e){for(var i=void 0,o=void 0,n=this.balls,a=Array.isArray(n),l=0,n=a?n:n[Symbol.iterator]();;){var r;if(a){if(l>=n.length)break;r=n[l++]}else{if((l=n.next()).done)break;r=l.value}var s=r;i=s.velocity.x/t,o=s.velocity.y/t,s.velocity.x=i*e,s.velocity.y=o*e}},t.prototype.onNumBalls=function(t){document.querySelector(".litNumBalls").textContent=t,this.fixArr(t)},t.prototype.onSizeBalls=function(t){document.querySelector(".litSizeBalls").textContent=t,this.radius=t},t.prototype.onSpeedBalls=function(t){this.updateUserSpeed(document.querySelector(".litSpeedBalls").textContent,t),document.querySelector(".litSpeedBalls").textContent=t},t.prototype.getRandomColor=function(){for(var t="#",e=0;e<6;++e)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},t}();