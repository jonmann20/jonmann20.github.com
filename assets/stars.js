"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),StarryBg=function(){function t(){var e=this;_classCallCheck(this,t),this.boundOnRoute=function(t){return e.destroy(t.detail)},addEventListener("route",this.boundOnRoute,!!pListen&&{passive:!0});var i=document.querySelector("input[type=radio]:checked").value;this.initStar(i);var n=Array.from(document.querySelectorAll("input[type=radio]")),o=!0,r=!1,s=void 0;try{for(var a,h=n[Symbol.iterator]();!(o=(a=h.next()).done);o=!0){var u=a.value;u.addEventListener("click",function(t){return e.onColorChange(t.target.value)})}}catch(t){r=!0,s=t}finally{try{!o&&h.return&&h.return()}finally{if(r)throw s}}}return _createClass(t,[{key:"destroy",value:function(t){var e=this;if("#playground/starry-background"!==t){removeEventListener("route",this.boundOnRoute,!!pListen&&{passive:!0}),cancelAnimationFrame(this.animLoop),this.starBg.destroy();var i=Array.from(document.querySelectorAll("input[type=radio]")),n=!0,o=!1,r=void 0;try{for(var s,a=i[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var h=s.value;h.removeEventListener("click",function(t){return e.onColorChange(t.target.value)})}}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}delete window.starryBg}}},{key:"initStar",value:function(t){this.starBg=new StarBg({elt:document.getElementById("starry-canvas"),window_width:util.getMainWidth(),window_height:400,star_color:t,star_count:1300,star_depth:330,container:"starry-canvas"})}},{key:"onColorChange",value:function(t){this.starBg.destroy(),delete this.starBg,this.initStar(t)}}]),t}(),StarBg=function(){function t(e){var i=this;_classCallCheck(this,t),this.w_b="#000",this.s_color=e.star_color,this.fov=e.star_depth,this.SCREEN_WIDTH=e.window_width,this.SCREEN_HEIGHT=e.window_height,this.HALF_WIDTH=this.SCREEN_WIDTH/2,this.HALF_HEIGHT=this.SCREEN_HEIGHT/2,this.mouse_x=0,this.mouse_y=0,this.numPoints=e.star_count,this.points=[],this.elt=e.elt,this.ctx=this.elt.getContext("2d"),this.elt.setAttribute("width",this.SCREEN_WIDTH),this.elt.setAttribute("height",this.SCREEN_HEIGHT),this.boundOnMouseMove=function(t){return i.onMouseMove(t)},document.addEventListener("mousemove",this.boundOnMouseMove),this.initPoints(),this.loop()}return _createClass(t,[{key:"destroy",value:function(){cancelAnimationFrame(this.animLoop),document.removeEventListener("mousemove",this.boundOnMouseMove)}},{key:"onMouseMove",value:function(t){this.mouse_x=t.pageX-this.HALF_WIDTH,this.mouse_y=t.pageY-this.HALF_HEIGHT}},{key:"initPoints",value:function(){for(var t=void 0,e=0;e<this.numPoints;++e)t=[400*Math.random()-200,400*Math.random()-200,400*Math.random()-200],this.points.push(t)}},{key:"loop",value:function(){var t=this;this.render(),this.animLoop=requestAnimationFrame(function(){return t.loop()})}},{key:"render",value:function(){this.ctx.fillStyle=this.w_b,this.ctx.fillRect(0,0,this.SCREEN_WIDTH,this.SCREEN_HEIGHT);for(var t=0;t<this.numPoints;++t){var e=this.points[t],i=e[2];i-=1.08,i<-this.fov&&(i+=400),e[2]=i,this.draw3Din2D(e)}}},{key:"draw3Din2D",value:function(t){var e=t[0],i=t[1],n=t[2],o=this.fov/(this.fov+n),r=e*o+this.HALF_WIDTH-this.mouse_x/3,s=i*o+this.HALF_HEIGHT-this.mouse_y/3;this.ctx.lineWidth=o,this.ctx.strokeStyle=this.s_color,this.ctx.beginPath(),this.ctx.moveTo(r,s),this.ctx.lineTo(r+o,s),this.ctx.stroke()}}]),t}();