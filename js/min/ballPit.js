var update={init:function(){for(var c in ballArr){ballArr[c].x+=ballArr[c].velocity.x;ballArr[c].y+=ballArr[c].velocity.y}var a;for(var c=0;c<ballArr.length;c++){a=ballArr[c];if(a.x<0&&a.velocity.x<0){a.velocity.x=-a.velocity.x}if(a.y>=canvas.height&&a.velocity.y>0){a.velocity.y=-a.velocity.y}if(a.x>=canvas.width&&a.velocity.x>0){a.velocity.x=-a.velocity.x}if(a.y<0&&a.velocity.y<0){a.velocity.y=-a.velocity.y}}}};var render={init:function(){ctx.fillStyle="#0098ff";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#e1e1e1";for(var a in ballArr){ctx.beginPath();ctx.arc(ballArr[a].x,ballArr[a].y,radius,0,2*Math.PI,false);ctx.fill();ctx.lineWidth=radius/15;ctx.strokeStyle="#19a2ff";ctx.stroke();ctx.closePath()}}};window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)}})();var runSim=function(){setTimeout(function(){requestAnimFrame(runSim);update.init();render.init()},1000/60)};var fixArr=function(a){var d=ballArr.length-a;if(d>0){for(var b=0;b<d;b++){ballArr.pop()}}else{if(d<0){d=-d;for(var b=0;b<d;b++){var c={x:Math.floor(Math.random()*(canvas.width-0+1))+0,y:Math.floor(Math.random()*(canvas.height+1)),velocity:{x:Math.floor(Math.random()*(2-(-2)+1))+(-2),y:Math.floor(Math.random()*(3-(-3)+1))+(-3)}};if(c.velocity.x==0){c.velocity.x=1}if(c.velocity.y==0){c.velocity.y=1}ballArr.push(c)}}}};var updateUserSpeed=function(c,g){var a,f,e;for(var d=0;d<ballArr.length;d++){a=ballArr[d];f=a.velocity.x/c;e=a.velocity.y/c;a.velocity.x=f*g;a.velocity.y=e*g}};var main=function(){for(var a=0;a<20;a++){var b={x:Math.floor(Math.random()*(canvas.width+1)),y:Math.floor(Math.random()*(canvas.height+1)),velocity:{x:Math.floor(Math.random()*(-3)),y:Math.floor(Math.random()*7)-3}};ballArr.push(b)}runSim()};$(function(){canvas=$("canvas")[0];ctx=canvas.getContext("2d");canvas.width=$(".main").width()/1.5;canvas.height=canvas.width/2;radius=3.5;ballArr=[];main();$(".numBalls").change(function(){var a=$(this).val();$(".litNumBalls").html(a);fixArr(a)});$(".sizeBalls").change(function(){var a=$(this).val();$(".litSizeBalls").html(a);radius=a});$(".speedBalls").change(function(){var a=$(this).val();updateUserSpeed($(".litSpeedBalls").html(),a);$(".litSpeedBalls").html(a)})});