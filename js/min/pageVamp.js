function GameEngine(){var a=document.createElement("a");a.href="/#games",a.innerText="Back",a.className="btnBack",document.body.appendChild(a);var b=document.createElement("div");b.className="canvasWrap",canvas=document.createElement("canvas"),canvas.setAttribute("width",1008),canvas.setAttribute("height",567),b.appendChild(canvas),document.body.appendChild(b),ctx=canvas.getContext("2d"),this.input=new GameInput(this),this.graphics=new GameGraphics(this),this.utils=new GameUtils(this),this.view=new GameView(this),this.init()}function GameSave(){}function GameInput(){function a(a){return a===KeyCode.W?a=KeyCode.UP:a===KeyCode.S?a=KeyCode.DOWN:a===KeyCode.D?a=KeyCode.RIGHT:a===KeyCode.A&&(a=KeyCode.LEFT),a}this.keysDown={},this.lastKeyUp=KeyCode.EMPTY,this.lastKeyDown=KeyCode.EMPTY;var b=this;addEventListener("keydown",function(c){var d=a(c.keyCode);b.keysDown[d]||(b.lastKeyDown=d,b.keysDown[d]=!0)}),addEventListener("keyup",function(c){b.lastKeyUp=a(c.keyCode),delete b.keysDown[b.lastKeyUp]})}function GameUtils(a){return{switchView:function(b){b.init(),a.view=b}}}function GameView(){this.privates={bgColor:"#ccc"},this.init()}function TitleView(a){this.privates={title:a},this.init()}function GameSaveView(){this.privates={},this.init()}function LevelView(){this.privates={},this.init()}!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-43015655-1","jonmann20.github.io"),ga("send","pageview"),GameEngine.prototype=function(){function a(){c.view.update()}function b(){e=requestAnimationFrame(b),c.view.render()}var c,d,e;return{init:function(){c=this},start:function(){d=setInterval(a,1e3/60),e=requestAnimationFrame(b)},stop:function(){clearInterval(d),cancelAnimationFrame(e)}}}(),GameSave.prototype=function(){return{load:function(a){return localStorage["slot"+a]},getList:function(){var a=this.load(0),b=this.load(1),c=this.load(2),d="---";return list=["undefined"!=typeof a?a:d,"undefined"!=typeof b?b:d,"undefined"!=typeof c?c:d]},save:function(a,b){localStorage["slot"+a]=b},erase:function(a){return localStorage.removeItem("slot"+a),this.getList()}}}(),GameInput.prototype=function(){return{update:function(){}}}();var KeyCode=Object.freeze({EMPTY:-1,ENTER:13,CTRL:17,ESC:27,SPACEBAR:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,A:65,D:68,F:70,H:72,J:74,K:75,M:77,O:79,R:82,S:83,W:87}),KeyCodeNames={};KeyCodeNames[-1]="EMPTY",KeyCodeNames[13]="ENTER",KeyCodeNames[17]="CTRL",KeyCodeNames[27]="ESC",KeyCodeNames[32]="SPACEBAR",KeyCodeNames[37]="LEFT",KeyCodeNames[38]="UP",KeyCodeNames[39]="RIGHT",KeyCodeNames[40]="DOWN",KeyCodeNames[46]="DELETE",KeyCodeNames[65]="A",KeyCodeNames[68]="D",KeyCodeNames[70]="F",KeyCodeNames[72]="H",KeyCodeNames[74]="J",KeyCodeNames[75]="K",KeyCodeNames[77]="M",KeyCodeNames[79]="O",KeyCodeNames[82]="R",KeyCodeNames[83]="S",KeyCodeNames[87]="W";var Dir=Object.freeze({RIGHT:0,LEFT:1}),GameGraphics=function(){return{isAnimating:!1,repeatAction:function(a,b,c){this.isAnimating=!0;var d=0,e=this,f=setInterval(function(){d++>b?(clearInterval(f),e.isAnimating=!1):c()},a)}}};GameView.prototype=function(){return{then:function(a){this.privates.callback=a},init:function(){},update:function(){},render:function(){ctx.fillStyle=this.privates.bgColor,ctx.fillRect(0,0,canvas.width,canvas.height)}}}(),TitleView.prototype=function(){var a,b="Press Enter";return{then:function(a){this.privates.callback=a},init:function(){a=this.privates.title},update:function(){game.input.lastKeyDown===KeyCode.ENTER&&(game.input.lastKeyDown=KeyCode.EMPTY,this.privates.callback())},render:function(){ctx.fillStyle="#000",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.font="36px Arial",ctx.fillStyle="#fff",ctx.fillText(a,canvas.width/2-ctx.measureText(a).width/2,100),ctx.font="24px Arial",ctx.fillText(b,canvas.width/2-ctx.measureText(b).width/2,canvas.height/2)}}}(),GameSaveView.prototype=function(){var a,b,c="Select a save slot",d=new GameSave,e=d.getList();return{then:function(a){this.privates.callback=a},init:function(){a=this,b={img:">>",slot:0,x:canvas.width/2-ctx.measureText(e[0]).width/2-60,y:200}},update:function(){if(game.input.lastKeyDown===KeyCode.ESC)game.input.lastKeyDown=KeyCode.EMPTY,this.privates.callback(KeyCode.ESC);else if(game.input.lastKeyDown===KeyCode.ENTER){game.input.lastKeyDown=KeyCode.EMPTY;var a=new Date,c=a.getMonth(),f=a.getDay(),g=a.getYear(),h=a.toLocaleTimeString();d.save(b.slot,c+"/"+f+"/"+g+" "+h),this.privates.callback(KeyCode.ENTER)}else game.input.lastKeyDown===KeyCode.DELETE?(game.input.lastKeyDownp=KeyCode.EMPTY,e=d.erase(b.slot)):2!==b.slot&&game.input.lastKeyDown===KeyCode.DOWN?(game.input.lastKeyDown=KeyCode.EMPTY,++b.slot,b.x=canvas.width/2-ctx.measureText(e[b.slot]).width/2-60,b.y+=80):0!==b.slot&&game.input.lastKeyDown===KeyCode.UP&&(game.input.lastKeyDown=KeyCode.EMPTY,--b.slot,b.x=canvas.width/2-ctx.measureText(e[b.slot]).width/2-60,b.y-=80)},render:function(){ctx.fillStyle="#111",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.font="36px Arial",ctx.fillStyle="#fff",ctx.fillText(c,canvas.width/2-ctx.measureText(c).width/2,80),ctx.font="24px Arial";for(var a=0;a<e.length;++a)ctx.fillText(e[a],canvas.width/2-ctx.measureText(e[a]).width/2,200+80*a);ctx.fillText(b.img,b.x,b.y)}}}(),LevelView.prototype=function(){var a;return{then:function(a){this.privates.callback=a},init:function(){a=this},update:function(){},render:function(){ctx.fillStyle="brown",ctx.fillRect(0,0,canvas.width,canvas.height)}}}(),function(){game=new GameEngine,game.start();var a=new TitleView("Vamp: The Great and Powerful",!0);a.then(function(){game.utils.switchView(b)});var b=new GameSaveView;b.then(function(b){b===KeyCode.ESC?game.utils.switchView(a):b===KeyCode.ENTER&&game.utils.switchView(c)});var c=new LevelView;game.view=a}();