function LevelView(a,b){this.privates={},this.player=a,this.curLvl=b,this.init()}function Level1(){this.init()}function Vamp(){this.init()}!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-43015655-1","jonmann20.github.io"),ga("send","pageview"),LevelView.prototype=function(){function a(){if(b.player.invincible)return void(0===b.player.invincibleTimer--&&(b.player.invincible=!1,b.player.invincibleTimer=120));for(var a=0;a<b.curLvl.projectiles.length;++a){var c=SAT.testPolygonPolygon(b.player,b.curLvl.projectiles[a]);if(c){--b.player.hp,b.player.invincible=!0;break}}}var b,c=!1,d=!1;return{then:function(a){this.privates.callback=a},init:function(){b=this},update:function(){this.curLvl.update(),this.player.update(),a()},onUpdate:function(a){c=!0,this.onUpdate=a},render:function(){this.curLvl.render(),this.player.render()},onRender:function(a){d=!0,this.onRender=a}}}(),Level1.prototype=function(){return{projectiles:[],init:function(){for(var a=0;10>a;++a){var b=new SAT.Box(new SAT.Vector(Math.floor(Math.random()*canvas.width+0),canvas.height),10,20).toPolygon();b.speed=.1*Math.floor(10*Math.random()+3),this.projectiles.push(b)}},update:function(){for(var a=0;a<this.projectiles.length;++a)this.projectiles[a].pos.y-=this.projectiles[a].speed},render:function(){ctx.fillStyle="#000",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="silver";for(var a=0;a<this.projectiles.length;++a)ctx.fillRect(this.projectiles[a].pos.x,this.projectiles[a].pos.y,10,20)}}}(),Vamp.prototype=function(){var a=new Image,b=!1;a.onload=function(){b=!0},a.src="img/vamp.png";var c=4;return{w:40,h:40,hp:3,invincible:!1,invincibleTimer:120,init:function(){$.extend(this,new SAT.Box(new SAT.Vector(0,0),this.w,this.h).toPolygon())},update:function(){game.input.keysDown[KeyCode.RIGHT]?this.pos.x+=c:game.input.keysDown[KeyCode.LEFT]&&(this.pos.x-=c),game.input.keysDown[KeyCode.UP]?this.pos.y-=c:game.input.keysDown[KeyCode.DOWN]&&(this.pos.y+=c),this.hp<=0&&(alert("You died"),location.reload())},render:function(){var a=!0;if(this.invincible){var b=this.invincibleTimer%30;b>=0&&15>b&&(a=!1)}a&&(ctx.fillStyle="yellow",ctx.fillRect(this.pos.x,this.pos.y,this.w,this.h)),ctx.fillStyle="red";for(var c=0;c<this.hp;++c)ctx.fillRect(this.pos.x-10+20*c,this.pos.y-20,20,10)}}}(),function(){game=new GameEngine,game.start();var a=new TitleView("Vamp: The Great and Powerful",!0);a.then(function(){game.utils.switchView(b)});var b=new GameSaveView;b.then(function(b){b===KeyCode.ESC?game.utils.switchView(a):b===KeyCode.ENTER&&game.utils.switchView(e)});var c=new Vamp,d=new Level1,e=new LevelView(c,d);game.view=a}();