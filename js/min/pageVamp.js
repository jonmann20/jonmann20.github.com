function GameEngine(){function a(){view.update()}function b(){requestAnimationFrame(b),view.render()}var c=document.createElement("div");return c.className="canvasWrap",canvas=document.createElement("canvas"),canvas.setAttribute("width",1008),canvas.setAttribute("height",567),c.appendChild(canvas),document.body.appendChild(c),ctx=canvas.getContext("2d"),input=new GameInput,view=new GameView,{start:function(){setInterval(a,1e3/60),requestAnimationFrame(b)}}}function GameSave(){}function GameSaveView(a,b){this.returnView=a,this.callback=b,this.init()}function GameInput(){function a(a){return a===KeyCode.W?a=KeyCode.UP:a===KeyCode.S&&(a=KeyCode.DOWN),a}keysDown={},lastKeyUp=KeyCode.EMPTY,addEventListener("keydown",function(b){keysDown[a(b.keyCode)]=!0},!0),addEventListener("keyup",function(b){lastKeyUp=a(b.keyCode),delete keysDown[lastKeyUp]},!1)}function GameView(){}function TitleView(a){this.callback=a}function LevelView(){}!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-43015655-1","jonmann20.github.io"),ga("send","pageview"),GameSave.prototype=function(){return{load:function(a){return localStorage["slot"+a]},getList:function(){var a=this.load(0),b=this.load(1),c=this.load(2),d="---";return list=["undefined"!=typeof a?a:d,"undefined"!=typeof b?b:d,"undefined"!=typeof c?c:d]},save:function(a,b){localStorage["slot"+a]=b},erase:function(a){return localStorage.removeItem("slot"+a),this.getList()}}}(),GameSaveView.prototype=function(){var a,b="Select a save slot",c=new GameSave,d=c.getList();return{init:function(){a={img:">>",slot:0,x:canvas.width/2-ctx.measureText(d[0]).width/2-60,y:200}},update:function(){if(lastKeyUp===KeyCode.ENTER){lastKeyUp=KeyCode.EMPTY;var b=new Date,e=b.getMonth(),f=b.getDay(),g=b.getYear(),h=b.toLocaleTimeString();c.save(a.slot,e+"/"+f+"/"+g+" "+h),this.callback()}else lastKeyUp===KeyCode.DELETE?(lastKeyUp=KeyCode.EMPTY,d=c.erase(a.slot)):2!==a.slot&&lastKeyUp===KeyCode.DOWN?(lastKeyUp=KeyCode.EMPTY,++a.slot,a.x=canvas.width/2-ctx.measureText(d[a.slot]).width/2-60,a.y+=80):0!==a.slot&&lastKeyUp===KeyCode.UP&&(lastKeyUp=KeyCode.EMPTY,--a.slot,a.x=canvas.width/2-ctx.measureText(d[a.slot]).width/2-60,a.y-=80)},render:function(){ctx.fillStyle="#111",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.font="36px Arial",ctx.fillStyle="#fff",ctx.fillText(b,canvas.width/2-ctx.measureText(b).width/2,80),ctx.font="24px Arial";for(var c=0;c<d.length;++c)ctx.fillText(d[c],canvas.width/2-ctx.measureText(d[c]).width/2,200+80*c);ctx.fillText(a.img,a.x,a.y)}}}();var KeyCode=Object.freeze({EMPTY:-1,ENTER:13,CTRL:17,ESC:27,SPACEBAR:32,UP:38,DOWN:40,DELETE:46,A:65,D:68,F:70,H:72,J:74,K:75,M:77,O:79,R:82,S:83,W:87}),KeyCodeNames={};KeyCodeNames[-1]="EMPTY",KeyCodeNames[13]="ENTER",KeyCodeNames[17]="CTRL",KeyCodeNames[27]="ESC",KeyCodeNames[32]="SPACEBAR",KeyCodeNames[38]="UP",KeyCodeNames[40]="DOWN",KeyCodeNames[46]="DELETE",KeyCodeNames[65]="A",KeyCodeNames[68]="D",KeyCodeNames[70]="F",KeyCodeNames[72]="H",KeyCodeNames[74]="J",KeyCodeNames[75]="K",KeyCodeNames[77]="M",KeyCodeNames[79]="O",KeyCodeNames[82]="R",KeyCodeNames[83]="S",KeyCodeNames[87]="W",GameView.prototype=function(){return{update:function(){},render:function(){ctx.fillStyle="#ccc",ctx.fillRect(0,0,canvas.width,canvas.height)}}}();var SAT={};!function(a){"use strict";var b=function(a,b){this.x=a||0,this.y=b||0};a.Vector=b,b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},b.prototype.perp=function(){var a=this.x;return this.x=this.y,this.y=-a,this},b.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},b.prototype.normalize=function(){var a=this.len();return a>0&&(this.x=this.x/a,this.y=this.y/a),this},b.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.scale=function(a,b){return this.x*=a,this.y*=b||a,this},b.prototype.project=function(a){var b=this.dot(a)/a.len2();return this.x=b*a.x,this.y=b*a.y,this},b.prototype.projectN=function(a){var b=this.dot(a);return this.x=b*a.x,this.y=b*a.y,this},b.prototype.projectN=b.prototype.projectN,b.prototype.reflect=function(a){var b=this.x,c=this.y;return this.project(a).scale(2),this.x-=b,this.y-=c,this},b.prototype.reflectN=function(a){var b=this.x,c=this.y;return this.projectN(a).scale(2),this.x-=b,this.y-=c,this},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.len2=function(){return this.dot(this)},b.prototype.len=function(){return Math.sqrt(this.len2())};var c=function(a,c){this.pos=a||new b,this.points=c||[],this.recalc()};a.Polygon=c,c.prototype.recalc=function(){var a=this.points,c=a.length;this.edges=[],this.normals=[];for(var d=0;c>d;d++){var e=a[d],f=c-1>d?a[d+1]:a[0],g=(new b).copy(f).sub(e),h=(new b).copy(g).perp().normalize();this.edges.push(g),this.normals.push(h)}};var d=function(a,c,d){this.pos=a||new b,this.w=c||0,this.h=d||0};a.Box=d,d.prototype.toPolygon=function(){var a=this.pos,d=this.w,e=this.h;return new c(new b(a.x,a.y),[new b,new b(d,0),new b(d,e),new b(0,e)])};for(var e=[],f=0;10>f;++f)e.push(new b);for(var g=[],f=0;5>f;++f)g.push([]);var h=function(){this.a=null,this.b=null,this.overlapN=new b,this.overlapV=new b,this.clear()};a.Response=h,h.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};var i=function(a,b,c){for(var d=Number.MAX_VALUE,e=-Number.MAX_VALUE,f=a.length,g=0;f>g;++g){var h=a[g].dot(b);d>h&&(d=h),h>e&&(e=h)}c[0]=d,c[1]=e},j=function(a,b,c,d,f,h){var j=g.pop(),k=g.pop(),l=e.pop().copy(b).sub(a),m=l.dot(f);if(i(c,f,j),i(d,f,k),k[0]+=m,k[1]+=m,j[0]>k[1]||k[0]>j[1])return e.push(l),g.push(j),g.push(k),!0;if(h){var n=0;if(j[0]<k[0])if(h.aInB=!1,j[1]<k[1])n=j[1]-k[0],h.bInA=!1;else{var o=j[1]-k[0],p=k[1]-j[0];n=p>o?o:-p}else if(h.bInA=!1,j[1]>k[1])n=j[0]-k[1],h.aInB=!1;else{var o=j[1]-k[0],p=k[1]-j[0];n=p>o?o:-p}var q=Math.abs(n);q<h.overlap&&(h.overlap=q,h.overlapN.copy(f),0>n&&h.overlapN.reverse())}return e.push(l),g.push(j),g.push(k),!1};a.testPolygonPolygon=function(a,b,c){for(var d=a.points,e=d.length,f=b.points,g=f.length,h=0;e>h;h++)if(j(a.pos,b.pos,d,f,a.normals[h],c))return!1;for(var h=0;g>h;h++)if(j(a.pos,b.pos,d,f,b.normals[h],c))return!1;return c&&(c.a=a,c.b=b,c.overlapV.copy(c.overlapN).scale(c.overlap)),!0}}(SAT),TitleView.prototype=function(){var a="Vamp: The Great and Powerful",b="Press Enter";return{update:function(){lastKeyUp===KeyCode.ENTER&&(lastKeyUp=KeyCode.EMPTY,view=new GameSaveView(this,this.callback))},render:function(){ctx.fillStyle="#000",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.font="36px Arial",ctx.fillStyle="#fff",ctx.fillText(a,canvas.width/2-ctx.measureText(a).width/2,100),ctx.font="24px Arial",ctx.fillText(b,canvas.width/2-ctx.measureText(b).width/2,canvas.height/2)}}}(),LevelView.prototype=function(){return{update:function(){},render:function(){ctx.fillStyle="brown",ctx.fillRect(0,0,canvas.width,canvas.height)}}}(),function(){var a=new GameEngine;a.start(),view=new TitleView(function(){view=new LevelView})}();